#+LANGUAGE: ru

#+AUTHOR: Судаков С.А.

# Smart quotes.
#+OPTIONS: ':t

# LaTeX formula export.
#+OPTIONS: tex:t

# Do not include title, author name, and table of contents (yet).
#+OPTIONS: title:nil
#+OPTIONS: author:nil
#+OPTIONS: toc:nil

# Custom styles. Requires the ox-odt fork.

# Hopefully the right page style.
#+ODT_EXTRA_AUTOMATIC_STYLES: <style:page-layout style:name="Mpm1">
#+ODT_EXTRA_AUTOMATIC_STYLES:   <style:page-layout-properties
#+ODT_EXTRA_AUTOMATIC_STYLES:     fo:margin-left="2.5cm"
#+ODT_EXTRA_AUTOMATIC_STYLES:     fo:margin-right="1cm"
#+ODT_EXTRA_AUTOMATIC_STYLES:     fo:margin-top="1cm"
#+ODT_EXTRA_AUTOMATIC_STYLES:     fo:margin-bottom="1cm"/>
#+ODT_EXTRA_AUTOMATIC_STYLES: </style:page-layout>

# Text styles.
#+ODT_EXTRA_STYLES: <style:default-style style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties style:font-name="Times New Roman"
#+ODT_EXTRA_STYLES:                          fo:font-size="14pt"
#+ODT_EXTRA_STYLES:                          style:line-spacing="150%"/>
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:text-align="justify"/>
#+ODT_EXTRA_STYLES: </style:default-style>
#+ODT_EXTRA_STYLES: <style:style style:name="UNN" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties fo:font-size="12pt"
#+ODT_EXTRA_STYLES:                          fo:font-weight="bold"/>
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:text-align="center"/>
#+ODT_EXTRA_STYLES: </style:style>
#+ODT_EXTRA_STYLES: <style:style style:name="UNN_top" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties fo:font-size="11pt"
#+ODT_EXTRA_STYLES:                          fo:font-weight="bold"/>
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:text-align="center"/>
#+ODT_EXTRA_STYLES: </style:style>
#+ODT_EXTRA_STYLES: <style:style style:name="TitlePage" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties fo:font-size="14pt"/>
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:text-align="center"
#+ODT_EXTRA_STYLES:                               fo:margin-bottom="0.18cm"/>
#+ODT_EXTRA_STYLES: </style:style>
#+ODT_EXTRA_STYLES: <style:style style:name="LabTitle" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties fo:font-size="16pt"/>
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:text-align="center"/>
#+ODT_EXTRA_STYLES: </style:style>
#+ODT_EXTRA_STYLES: <style:style style:name="MagicTable" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties fo:font-size="12pt"/>
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:text-align="left"/>
#+ODT_EXTRA_STYLES: </style:style>
#+ODT_EXTRA_STYLES: <style:style style:name="Subscript" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties fo:font-size="8pt"/>
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:text-align="left"/>
#+ODT_EXTRA_STYLES: </style:style>
#+ODT_EXTRA_STYLES: <style:style style:name="PageBreak" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:break-before="page"/>
#+ODT_EXTRA_STYLES: </style:style>
#+ODT_EXTRA_STYLES: <style:style style:name="Selo" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties fo:font-size="12pt"/>
#+ODT_EXTRA_STYLES:   <style:paragraph-properties fo:text-align="right"/>
#+ODT_EXTRA_STYLES: </style:style>
#+ODT_EXTRA_STYLES: <style:style style:name="Epic18" style:family="paragraph">
#+ODT_EXTRA_STYLES:   <style:text-properties fo:font-size="18pt"/>
#+ODT_EXTRA_STYLES: </style:style>

# University year for formatting purposes.

# Subtract the entrance date from the current.
# Convert it to seconds, divide that by a year, and ceil.
# This _should_ result in a meaningful "year" value.

#+MACRO: year (eval (ceiling (/ (float (string-to-number (format-time-string "%s" (time-subtract (current-time) (date-to-time "Tue, 1 Sep 2020 00:00:00"))))) (* 60 60 24 30 12))))

# Labwork number extracted from directory name with regexps.
#+MACRO: number (eval (let ((string default-directory)) (string-match "L\\([0-9]+\\)/$" string) (match-string 1 string)))

# Utilities.

# Insert a page break.
#+MACRO: pagebr #+ODT: <text:p text:style-name="PageBreak"/>

# They really abused those in the OG file.
#+MACRO: newline12 #+ODT: <text:p text:style-name="UNN"/>
#+MACRO: newline14 #+ODT: <text:p text:style-name="TitlePage"/>
#+MACRO: newline16 #+ODT: <text:p text:style-name="LabTitle"/>
#+MACRO: newline18 #+ODT: <text:p text:style-name="Epic18"/>

# The juice.

#+ATTR_ODT: :style "UNN_top"
МИНИСТЕРСТВО НАУКИ И ВЫСШЕГО ОБРАЗОВАНИЯ РОССИЙСКОЙ ФЕДЕРАЦИИ

#+ATTR_ODT: :style "UNN"
федеральное государственное автономное образовательное
учреждение высшего образования "Национальный исследовательский
Нижегородский государственный университет им. Н.И. Лобачевского"

#+ATTR_ODT: :style "UNN"
(ННГУ)

{{{newline12}}}
{{{newline12}}}

#+ATTR_ODT: :style "TitlePage"
Павловский филиал

{{{newline14}}}
{{{newline14}}}
{{{newline14}}}

#+ATTR_ODT: :style "TitlePage"
Направление подготовки

#+ATTR_ODT: :style "TitlePage"
«Прикладная информатика»

{{{newline14}}}
{{{newline16}}}
{{{newline16}}}
{{{newline16}}}

#+ATTR_ODT: :style "LabTitle"
Лабораторная работа №{{{number}}}

{{{newline16}}}

#+ATTR_ODT: :style "LabTitle"
{{{title}}}

{{{newline18}}}
{{{newline18}}}

#+ATTR_ODT: :rel-width 100
#+ATTR_ODT: :list-table t
-
  -
  -
    #+ATTR_ODT: :style "MagicTable"
    \\
    Выполнил студент {{{year}}} курса\\
    очной формы обучения\\
    (гр. 3020Б1ПИ)\\
    _{{{author}}}_
    #+ATTR_ODT: :style "Subscript"
                          (ФИО)

#+ATTR_ODT: :rel-width 100
#+ATTR_ODT: :list-table t
#+ATTR_ODT: :style "MagicTable"
-
  -
    #+ATTR_ODT: :style "Selo"
    г. Павлово\\
    {{{time(%Y)}}}
  -
    #+ATTR_ODT: :style "MagicTable"
    \\
    Проверил:\\
    _доц. к.т.н. Васин Д.Ю._
    #+ATTR_ODT: :style "Subscript"
    (уч. звание, должность, ФИО)
    #+ATTR_ODT: :style "MagicTable"
    \\
    \\
    \\
    \\
    \\
    \\
    \\
    \\
    \\
    \\
    \\

{{{pagebr}}}

# TODO: page numbering is still manual. The A1 of the second table has
# to have bottom alignment, but it doesn't.
